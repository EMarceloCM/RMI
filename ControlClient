import java.rmi.Naming;
import java.util.Scanner;

public class ControlClient {
    public static void main(String[] args) {
        if (args.length < 3) {
            System.out.println("Uso: java ControlClient <hostStation1> <hostStation2> <hostStation3>");
            System.exit(0);
        }

        try {
            String host1 = args[0]; // ex: "192.168.0.101"
            String host2 = args[1]; // ex: "192.168.0.102"
            String host3 = args[2]; // ex: "192.168.0.103"

            IStation stub1 = (IStation) Naming.lookup("rmi://" + host1 + "/Station1");
            IStation stub2 = (IStation) Naming.lookup("rmi://" + host2 + "/Station2");
            IStation stub3 = (IStation) Naming.lookup("rmi://" + host3 + "/Station3");

            Scanner scanner = new Scanner(System.in);
            while (true) {
                System.out.println("\n=== Menu da Estação de Controle ===");
                System.out.println("1) Selecionar Estação 1");
                System.out.println("2) Selecionar Estação 2");
                System.out.println("3) Selecionar Estação 3");
                System.out.println("0) Sair");
                System.out.print("\nEscolha uma estação: ");
                int escolhaEstacao = scanner.nextInt();
                if (escolhaEstacao == 0) {
                    System.out.println("Encerrando estação de controle.");
                    break;
                }

                IStation estacaoSelecionada = null;
                String nomeEstacao = "";
                if (escolhaEstacao == 1) {
                    estacaoSelecionada = stub1;
                    nomeEstacao = "Station1";
                } else if (escolhaEstacao == 2) {
                    estacaoSelecionada = stub2;
                    nomeEstacao = "Station2";
                } else if (escolhaEstacao == 3) {
                    estacaoSelecionada = stub3;
                    nomeEstacao = "Station3";
                } else {
                    System.out.println("Opção inválida. Tente novamente.");
                    continue;
                }

                System.out.println("\n---- Ações Disponíveis em " + nomeEstacao + " ----");
                System.out.println("1. Tocar canto de pássaro");
                System.out.println("2. Alterar padrão de som");
                System.out.println("3. Pausar áudio");
                System.out.println("4. Retomar áudio");
                System.out.println("0. Trocar estação / Sair");
                System.out.print("\nEscolha uma ação: ");
                int escolhaAcao = scanner.nextInt();
                scanner.nextLine(); // consumir newline

                if (escolhaAcao == 1) {
                    System.out.print("Informe o ID do canto (ex: 1, 2 ou 3): ");
                    int songId = scanner.nextInt();
                    estacaoSelecionada.playBirdSong(songId);
                } else if (escolhaAcao == 2) {
                    System.out.print("Informe o novo padrão de som (string): ");
                    String pattern = scanner.nextLine();
                    estacaoSelecionada.changeSoundPattern(pattern);
                } else if (escolhaAcao == 3) {
                    estacaoSelecionada.pauseAudio();
                } else if (escolhaAcao == 4) {
                    estacaoSelecionada.resumeAudio();
                } else if (escolhaAcao == 0) {
                    break;
                } else {
                    System.out.println("Ação inválida. Retornando ao menu principal.");
                }
            }

            scanner.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}